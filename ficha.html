<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåü Ficha de Pr√©-Matr√≠cula do Aluno üåü</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One:wght@400&family=Nunito:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Nunito', sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #ff9a9e 0%, #0018f3 50%, #fecfef 90%);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        /* Elementos decorativos flutuantes */
        .floating-elements {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .floating-star, .floating-heart, .floating-balloon {
            position: absolute;
            animation: float 6s ease-in-out infinite;
            opacity: 0.7;
        }

        .floating-star:nth-child(1) { top: 10%; left: 10%; animation-delay: 0s; font-size: 20px; }
        .floating-star:nth-child(2) { top: 20%; right: 15%; animation-delay: 1s; font-size: 25px; }
        .floating-heart:nth-child(3) { top: 60%; left: 5%; animation-delay: 2s; font-size: 18px; }
        .floating-balloon:nth-child(4) { top: 40%; right: 10%; animation-delay: 3s; font-size: 22px; }
        .floating-star:nth-child(5) { top: 80%; left: 20%; animation-delay: 4s; font-size: 16px; }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            25% { transform: translateY(-10px) rotate(5deg); }
            50% { transform: translateY(-5px) rotate(-3deg); }
            75% { transform: translateY(-15px) rotate(3deg); }
        }

        .form-container {
            max-width: 900px;
            margin: 2em auto;
            padding: 2.5em;
            background: linear-gradient(145deg, #ffffff 0%, #f8f9ff 100%);
            border-radius: 25px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1), 0 0 0 3px #ff6b9d;
            position: relative;
            z-index: 2;
            border: 4px solid transparent;
            background-clip: padding-box;
        }

        .form-container::before {
            content: '';
            position: absolute;
            top: -4px;
            left: -4px;
            right: -4px;
            bottom: -4px;
            background: linear-gradient(45deg, #ff6b9d, #4ecdc4, #45b7d1, #96ceb4, #feca57);
            border-radius: 29px;
            z-index: -1;
        }

        .header-section {
            text-align: center;
            margin-bottom: 2em;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2em;
            border-radius: 20px;
            position: relative;
            overflow: hidden;
        }

        .header-section::before {
            content: 'üåà‚ú®üéí‚ú®üåà';
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 1.2em;
            animation: sparkle 2s ease-in-out infinite;
        }

        @keyframes sparkle {
            0%, 100% { opacity: 0.7; transform: translateX(-50%) scale(1); }
            50% { opacity: 1; transform: translateX(-50%) scale(1.1); }
        }

        .form-container h2 {
            font-family: 'Fredoka One', cursive;
            font-size: 2.2em;
            color: #fff;
            margin: 0.5em 0 0.2em 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .subtitle {
            font-size: 1.1em;
            opacity: 0.9;
            margin: 0;
        }

        .section-header {
            font-family: 'Fredoka One', cursive;
            font-size: 1.4em;
            color: #333;
            margin: 2em 0 1em 0;
            text-align: center;
            padding: 0.8em;
            background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%);
            border-radius: 15px;
            border: 3px solid #e17055;
            position: relative;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .section-header::before {
            content: attr(data-icon);
            font-size: 1.2em;
            margin-right: 0.5em;
        }

        .input-group {
            position: relative;
            margin: 1em 0;
        }

        .form-container input,
        .form-container textarea,
        .form-container select {
            width: 100%;
            padding: 1em 1.2em;
            border-radius: 15px;
            border: 3px solid #ddd;
            font-size: 1em;
            font-family: 'Nunito', sans-serif;
            background: #fff;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            text-transform: uppercase;
        }

        .form-container input:focus,
        .form-container textarea:focus,
        .form-container select:focus {
            outline: none;
            border-color: #ff6b9d;
            box-shadow: 0 0 0 3px rgba(255, 107, 157, 0.2), 0 5px 15px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        .form-container input:invalid {
            border-color: #ff7675;
            background-color: #fff5f5;
        }

        .form-container input:valid {
            border-color: #00b894;
            background-color: #f0fff4;
        }

        .photo-container {
            position: relative;
            display: inline-block;
            width: 100%;
        }

        .photo-preview {
            display: none;
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 4px solid #ff6b9d;
            object-fit: cover;
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            z-index: 3;
        }

        .photo-input {
            padding-right: 140px !important;
        }

        .file-input-wrapper {
            position: relative;
            display: inline-block;
            width: 100%;
            margin: 1em 0;
        }

        .file-input-label {
            display: block;
            padding: 1em;
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            color: white;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            border: 3px solid #0984e3;
        }

        .file-input-label:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        .file-input-label::before {
            content: 'üì∑ ';
            font-size: 1.2em;
        }

        input[type="file"] {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .toggle-section {
            background: linear-gradient(135deg, #fd79a8 0%, #fdcb6e 100%);
            padding: 1.5em;
            border-radius: 15px;
            margin: 1.5em 0;
            border: 3px solid #e84393;
        }

        .toggle-section select {
            background: white;
            font-weight: 600;
        }

        .hidden-section {
            display: none;
            margin-top: 1em;
            padding: 1em;
            background: rgba(255,255,255,0.8);
            border-radius: 10px;
            border: 2px dashed #e84393;
        }

        .checkbox-container {
            display: flex;
            align-items: center;
            margin: 1.5em 0;
            padding: 1em;
            background: linear-gradient(135deg, #a29bfe 0%, #6c5ce7 100%);
            border-radius: 15px;
            color: white;
        }

        .checkbox-container input[type="checkbox"] {
            width: auto;
            margin-right: 1em;
            transform: scale(1.5);
        }

        .checkbox-container a {
            color: #ffeaa7;
            text-decoration: underline;
            font-weight: 600;
        }

        .print-button {
            background: linear-gradient(135deg, #00cec9 0%, #55a3ff 100%);
            color: #fff;
            border: none;
            padding: 1.2em 2.5em;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 700;
            font-family: 'Fredoka One', cursive;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
            border: 3px solid #00b894;
            display: block;
            margin: 2em auto;
        }

        .print-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 25px rgba(0,0,0,0.3);
        }

        .print-button::before {
            content: 'üñ®Ô∏è ';
            font-size: 1.2em;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: linear-gradient(135deg, #ffffff 0%, #f1f3f4 100%);
            margin: 5% auto;
            padding: 2em;
            border: none;
            width: 80%;
            max-width: 600px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            position: relative;
        }

        .close {
            color: #ff6b9d;
            float: right;
            font-size: 2em;
            font-weight: bold;
            background: none;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .close:hover {
            color: #e84393;
            transform: scale(1.2);
        }

        @media print {
            body, html {
                background: #fff !important;
                color: #000 !important;
                margin: 0;
                padding: 0;
                width: 210mm;
                height: 297mm;
                font-size: 12pt;
            }
            .floating-elements, .print-button, .file-input-wrapper, .checkbox-container, .modal, .section-header[data-icon], .subtitle, .form-container::before, .header-section::before, .header-section, .photo-preview, .file-input-label, .toggle-section, .hidden-section, .notificacao, [class*="floating-"] {
                display: none !important;
            }
            .form-container {
                box-shadow: none !important;
                border: none !important;
                margin: 0 !important;
                padding: 0 !important;
                background: #fff !important;
                max-width: 100% !important;
            }
            #fichaTabelaImpressao {
                display: table !important;
                width: 100%;
                border-collapse: collapse;
                margin: 0 auto;
                font-size: 12pt;
            }
            #fichaTabelaImpressao th, #fichaTabelaImpressao td {
                border: 1px solid #000;
                padding: 6px 10px;
                text-align: left;
                background: #fff !important;
                color: #000 !important;
            }
            #fichaTabelaImpressao th {
                font-weight: bold;
                background: #f2f2f2 !important;
            }
            #fichaTabelaImpressao img {
                max-width: 100px;
                max-height: 120px;
                float: right;
                margin-left: 10px;
                border: 1px solid #000;
            }
            #form-content form, #form-content .form-container > *:not(#fichaTabelaImpressao) {
                display: none !important;
            }
        }

        @media (max-width: 768px) {
            .form-container {
                margin: 1em;
                padding: 1.5em;
            }
            .header-section {
                padding: 1.5em;
            }
            .form-container h2 {
                font-size: 1.8em;
            }
            .photo-preview {
                position: static;
                transform: none;
                margin: 1em auto;
                display: block;
            }
            .photo-input {
                padding-right: 1.2em !important;
            }
        }

        th, td { padding: 10px 12px; text-align: left; font-size: 1em; word-break: break-word; max-width: 0; }
        td { max-width: 350px; white-space: pre-line; }
        .ficha-container { max-width: 900px; margin: 2em auto; background: #fff; border-radius: 18px; box-shadow: 0 8px 32px #0001; padding: 2em; }
        table { width: 100%; border-collapse: separate; border-spacing: 0 8px; table-layout: fixed; }
        @media print { body, html { background: #fff !important; color: #000 !important; } .ficha-container { box-shadow: none !important; border: none !important; } }
    </style>
</head>
<body>
    <div class="floating-elements">
        <div class="floating-star">‚≠ê</div>
        <div class="floating-star">üåü</div>
        <div class="floating-heart">üíñ</div>
        <div class="floating-balloon">üéà</div>
        <div class="floating-star">‚ú®</div>
    </div>

    <div class="form-container" id="form-content">
        <div class="header-section">
            <h2>üåü Ficha de Pr√©-Matr√≠cula üåü</h2>
            <p class="subtitle">Vamos conhecer nosso novo amiguinho! üéí‚ú®</p>
        </div>

        <form id="fichaForm" novalidate>
            <h3 class="section-header" data-icon="üë¶üëß">Informa√ß√µes do Nosso Pequeno Estudante</h3>
            
            <div class="input-group photo-container">
                <input type="text" name="nomeAluno" placeholder="üé≠ Nome Completo do Aluno" required class="photo-input" aria-label="Nome Completo">
                <img id="previewFotoAluno" class="photo-preview" alt="Foto do aluno">
            </div>
            
            <div class="file-input-wrapper">
                <label for="fotoAluno" class="file-input-label">Adicionar Foto do Aluno</label>
                <input type="file" id="fotoAluno" name="fotoAluno" accept="image/*" onchange="previewImage('fotoAluno', 'previewFotoAluno')" aria-label="Foto do aluno">
            </div>

            <div class="input-group">
                <input type="date" name="dataNascimento" placeholder="üéÇ Data de Nascimento" required aria-label="Data de Nascimento">
            </div>

            <div class="input-group">
                <select name="nacionalidade" required aria-label="Nacionalidade">
                    <option value="">üåç Nacionalidade</option>
                    <option value="brasileiro">üáßüá∑ Brasileiro</option>
                    <option value="estrangeiro">üåé Estrangeiro</option>
                </select>
            </div>

            <div class="input-group">
                <input type="text" name="naturalidade" placeholder="üè† Naturalidade (cidade e estado)" required aria-label="Naturalidade">
            </div>

            <div class="input-group">
                <select name="genero" required aria-label="G√™nero">
                    <option value="">üë§ G√™nero</option>
                    <option value="masculino">üë¶ Masculino</option>
                    <option value="feminino">üëß Feminino</option>
                </select>
            </div>

            <div class="input-group">
                <input type="text" id="cep" name="cep" placeholder="üìÆ CEP" required onblur="buscarCep()" aria-label="CEP">
            </div>

            <div class="input-group">
                <input type="text" id="logradouro" name="logradouro" placeholder="üèòÔ∏è Logradouro" required aria-label="Logradouro">
            </div>

            <div class="input-group">
                <input type="text" id="numero" name="numero" placeholder="üî¢ N√∫mero" required aria-label="N√∫mero">
            </div>

            <div class="input-group">
                <input type="text" id="complemento" name="complemento" placeholder="üè¢ Complemento" aria-label="Complemento">
            </div>

            <div class="input-group">
                <input type="text" id="bairro" name="bairro" placeholder="üèòÔ∏è Bairro" required aria-label="Bairro">
            </div>

            <div class="input-group">
                <input type="text" id="cidade" name="cidade" placeholder="üèôÔ∏è Cidade" required aria-label="Cidade">
            </div>

            <div class="input-group">
                <input type="text" id="uf" name="uf" placeholder="üó∫Ô∏è Estado" required aria-label="Estado">
            </div>

            <div class="input-group">
                <input type="tel" name="telefone" placeholder="üì± Telefones de Contato" required aria-label="Telefone de Contato">
            </div>

            <div class="input-group">
                <input type="email" name="email" placeholder="üìß E-mail" required aria-label="E-mail">
            </div>

            <div class="input-group">
                <input type="text" name="rg" placeholder="üÜî N√∫mero do RG" required aria-label="RG">
            </div>

            <div class="input-group">
                <input type="text" name="cpf" placeholder="üìÑ CPF (se aplic√°vel)" aria-label="CPF">
            </div>

            <div class="input-group">
                <input type="text" name="certidao" placeholder="üìú N√∫mero da Certid√£o de Nascimento" required aria-label="Certid√£o">
            </div>

            <div class="input-group">
                <input type="text" name="raca" placeholder="üåà Ra√ßa/Cor (opcional)" aria-label="Ra√ßa/Cor">
            </div>

            <h3 class="section-header" data-icon="ü´Ç">Necessidades Especiais</h3>
            <div class="toggle-section">
                <label>üíù Nosso aluno possui necessidades especiais?</label>
                <select id="necessidadeSelect" onchange="toggleNecessidadeInput()" aria-label="Possui necessidades especiais?">
                    <option value="">Selecione</option>
                    <option value="sim">‚úÖ Sim</option>
                    <option value="nao">‚ùå N√£o</option>
                </select>
                <div id="necessidadeInput" class="hidden-section">
                    <input type="text" name="especificacaoNecessidade" placeholder="üí¨ Conte-nos quais necessidades especiais" aria-label="Especifique necessidades especiais">
                </div>
            </div>

            <h3 class="section-header" data-icon="üë®‚Äçüë©‚Äçüëß‚Äçüë¶">Fam√≠lia do Nosso Aluno</h3>
            <div class="input-group">
                <input type="text" name="nomePai" placeholder="üë® Nome do Papai" aria-label="Nome do Pai">
            </div>
            <div class="input-group">
                <input type="text" name="nomeMae" placeholder="üë© Nome da Mam√£e" aria-label="Nome da M√£e">
            </div>

            <h3 class="section-header" data-icon="üë§">Respons√°vel pela Ficha</h3>
            <div class="input-group">
                <input type="text" name="nomeResponsavel" placeholder="üë§ Nome Completo do Respons√°vel" required aria-label="Nome do Respons√°vel">
            </div>
            <div class="input-group">
                <input type="text" name="rgResponsavel" placeholder="üÜî RG do Respons√°vel" required aria-label="RG do Respons√°vel">
            </div>
            <div class="input-group">
                <input type="text" name="cpfResponsavel" placeholder="üìÑ CPF do Respons√°vel" required aria-label="CPF do Respons√°vel">
            </div>
            <div class="input-group">
                <input type="text" id="cepResponsavel" name="cepResponsavel" placeholder="üìÆ CEP do Respons√°vel" required onblur="buscarCepResponsavel()" aria-label="CEP do Respons√°vel">
            </div>
            <div class="input-group">
                <input type="text" id="logradouroResponsavel" name="logradouroResponsavel" placeholder="üèòÔ∏è Logradouro do Respons√°vel" required aria-label="Logradouro do Respons√°vel">
            </div>
            <div class="input-group">
                <input type="text" id="numeroResponsavel" name="numeroResponsavel" placeholder="üî¢ N√∫mero" aria-label="N√∫mero do Respons√°vel">
            </div>
            <div class="input-group">
                <input type="text" id="complementoResponsavel" name="complementoResponsavel" placeholder="üè¢ Complemento" aria-label="Complemento do Respons√°vel">
            </div>
            <div class="input-group">
                <input type="text" id="bairroResponsavel" name="bairroResponsavel" placeholder="üèòÔ∏è Bairro do Respons√°vel" required aria-label="Bairro do Respons√°vel">
            </div>
            <div class="input-group">
                <input type="text" id="cidadeResponsavel" name="cidadeResponsavel" placeholder="üèôÔ∏è Cidade do Respons√°vel" required aria-label="Cidade do Respons√°vel">
            </div>
            <div class="input-group">
                <input type="text" id="ufResponsavel" name="ufResponsavel" placeholder="üó∫Ô∏è Estado do Respons√°vel" required aria-label="Estado do Respons√°vel">
            </div>
            <div class="input-group">
                <input type="tel" name="telefoneResponsavel" placeholder="üì± Telefone do Respons√°vel" required aria-label="Telefone do Respons√°vel">
            </div>
            <div class="input-group">
                <input type="text" name="profissaoResponsavel" placeholder="üíº Profiss√£o do Respons√°vel" required aria-label="Profiss√£o do Respons√°vel">
            </div>
            <div class="input-group">
                <input type="email" name="emailResponsavel" placeholder="üìß E-mail do Respons√°vel" required aria-label="E-mail do Respons√°vel">
            </div>

            <h3 class="section-header" data-icon="üöó">Transporte Escolar</h3>
            <div class="toggle-section">
                <label>üöå Quem ir√° buscar e levar nosso aluno?</label>
                <select id="quemBuscarLevar" onchange="toggleOutrosDados()" aria-label="Quem ir√° buscar e levar o aluno?">
                    <option value="">Selecione</option>
                    <option value="pai">üë® Papai</option>
                    <option value="mae">üë© Mam√£e</option>
                    <option value="outros">üë• Outra pessoa</option>
                </select>
                <div id="outrosDados" class="hidden-section">
                    <div class="photo-container">
                        <input type="text" name="nomeOutros" placeholder="üë§ Nome Completo da Pessoa" aria-label="Nome Completo de outra pessoa" class="photo-input">
                        <img id="previewFotoOutrosRosto" class="photo-preview" alt="Foto do rosto da pessoa" style="width:90px;height:110px;object-fit:cover;border-radius:12px;border:3px solid #ff6b9d;padding:2px;background:#fff;box-shadow:0 2px 8px #ccc;">
                    </div>
                    <div class="file-input-wrapper">
                        <label for="fotoOutrosRosto" class="file-input-label">Adicionar Foto do Rosto (3x4)</label>
                        <input type="file" id="fotoOutrosRosto" name="fotoOutrosRosto" accept="image/*" onchange="previewImage('fotoOutrosRosto', 'previewFotoOutrosRosto')" aria-label="Foto do rosto da pessoa">
                    </div>
                    <div class="file-input-wrapper">
                        <label for="fotoOutrosRG" class="file-input-label">Adicionar Foto do RG/Documento</label>
                        <input type="file" id="fotoOutrosRG" name="fotoOutrosRG" accept="image/*" onchange="previewImage('fotoOutrosRG', 'previewFotoOutrosRG')" aria-label="Foto do RG da pessoa">
                    </div>
                    <img id="previewFotoOutrosRG" style="display:none;width:120px;height:80px;border-radius:10px;border:3px solid #0984e3;object-fit:cover;margin-top:10px;" alt="Foto do RG da pessoa">
                    <input type="text" name="rgOutros" placeholder="üÜî RG" aria-label="RG de outra pessoa">
                    <input type="text" name="cpfOutros" placeholder="üìÑ CPF" aria-label="CPF de outra pessoa">
                    <input type="tel" name="telefoneOutros" placeholder="üì± Telefone de Contato" aria-label="Telefone de contato de outra pessoa">
                    <input type="email" name="emailOutros" placeholder="üìß E-mail" aria-label="E-mail de outra pessoa">
                </div>
            </div>

            <h3 class="section-header" data-icon="üè•">Informa√ß√µes de Sa√∫de</h3>
            <div class="input-group">
                <textarea name="infoMedicas" placeholder="üíä INFORMA√á√ïES M√âDICAS IMPORTANTES (ALERGIAS, MEDICAMENTOS, CONDI√á√ïES ESPECIAIS)" required aria-label="Informa√ß√µes M√©dicas" rows="4" maxlength="140" style="text-transform:uppercase;"></textarea>
            </div>
            <div class="input-group">
                <input type="text" name="planoSaude" placeholder="üè• Nome do Plano de Sa√∫de (se tiver)" aria-label="Plano de Sa√∫de">
            </div>
            <div class="input-group">
                <input type="text" name="contatoEmergencia" placeholder="üö® Contato de Emerg√™ncia (nome e telefone)" required aria-label="Contato de Emerg√™ncia">
            </div>

            <h3 class="section-header" data-icon="üè†">Informa√ß√µes da Fam√≠lia (opcional)</h3>
            <div class="input-group">
                <input type="text" name="rendaFamiliar" placeholder="üí∞ Renda Familiar" aria-label="Renda Familiar">
            </div>
            <div class="input-group">
                <textarea name="composicaoFamiliar" placeholder="üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Como √© formada nossa fam√≠lia?" aria-label="Composi√ß√£o Familiar" rows="3"></textarea>
            </div>
            <div class="input-group">
                <input type="text" name="beneficiosSociais" placeholder="ü§ù Benef√≠cios Sociais (Bolsa Fam√≠lia, etc.)" aria-label="Benef√≠cios Sociais">
            </div>

            <div class="checkbox-container">
                <input type="checkbox" name="termos" required aria-label="Aceito os termos e condi√ß√µes">
                <label>
                    üìã Eu li e aceito os <a href="#" onclick="abrirModal()">termos e condi√ß√µes</a> da escola.
                </label>
            </div>
            <button type="button" class="print-button" style="background:linear-gradient(135deg,#636e72 0%,#b2bec3 100%);border-color:#636e72;" onclick="exportarComoHTML()">Exportar para impress√£o</button>
        </form>
    </div>

    <div id="modalTermos" class="modal" aria-hidden="true" role="dialog">
        <div class="modal-content">
            <span class="close" onclick="fecharModal()" aria-label="Fechar">&times;</span>
            <h2>üìã TERMO DE CONDI√á√ïES E TRATAMENTO DE DADOS PESSOAIS</h2>
            <p>
                Ao preencher a presente ficha, declaro que as informa√ß√µes pessoais fornecidas, incluindo, mas n√£o se limitando a, nome, endere√ßo, telefone, e-mail, dados acad√™micos e qualquer outra informa√ß√£o solicitada, s√£o verdadeiras, completas e precisas. Compreendo que esses dados ser√£o coletados e tratados pela [Nome da Escola] em conformidade com a Lei Geral de Prote√ß√£o de Dados Pessoais (Lei n¬∫ 13.709/2018 - LGPD), e que ser√£o utilizados exclusivamente para fins educacionais e administrativos, como registro acad√™mico, comunica√ß√£o com os respons√°veis, e acompanhamento do desempenho escolar dos alunos, entre outras finalidades relacionadas ao processo educacional.
            </p>
            <p>
                Estou ciente de que os dados pessoais fornecidos ser√£o armazenados pela [Nome da Escola] por tempo indeterminado, ou seja, enquanto for necess√°rio para o cumprimento das finalidades educacionais e administrativas, bem como para o cumprimento de obriga√ß√µes legais e regulat√≥rias, mesmo ap√≥s o t√©rmino do v√≠nculo do aluno com a institui√ß√£o. Entendo que esses dados poder√£o ser compartilhados com terceiros, incluindo autoridades educacionais e outros parceiros institucionais, sempre de acordo com a legisla√ß√£o vigente e para fins estritamente relacionados √†s atividades da escola.
            </p>
            <p>
                Reconhe√ßo que a [Nome da Escola] adotou medidas de seguran√ßa apropriadas para proteger os dados pessoais contra acessos n√£o autorizados, altera√ß√µes, divulga√ß√µes ou destrui√ß√µes indevidas. No entanto, compreendo que, apesar dos esfor√ßos empreendidos, a seguran√ßa absoluta dos dados na internet n√£o pode ser totalmente garantida.
            </p>
            <p>
                Al√©m disso, declaro que todas as informa√ß√µes fornecidas s√£o verdadeiras e precisas, ciente de que qualquer falsa declara√ß√£o ou omiss√£o pode acarretar em san√ß√µes legais, conforme previsto na legisla√ß√£o aplic√°vel. Tenho ci√™ncia de que, conforme a LGPD, possuo o direito de acessar, corrigir, atualizar e solicitar a exclus√£o dos meus dados pessoais a qualquer momento, entrando em contato com a escola atrav√©s do e-mail [inserir e-mail de contato]. Contudo, entendo que a exclus√£o dos dados poder√° ser limitada em casos onde o armazenamento seja necess√°rio para o cumprimento de obriga√ß√µes legais ou regulat√≥rias.
            </p>
            <p>
                A funda√ß√£o escola solid√°ria se reserva o direito de alterar este Termo de Condi√ß√µes e Tratamento de Dados Pessoais a qualquer momento, sendo que as modifica√ß√µes entrar√£o em vigor ap√≥s a publica√ß√£o da vers√£o atualizada em seu site ou mediante comunica√ß√£o direta aos respons√°veis pelos alunos.
            </p>
            <p>
                Por fim, ao submeter esta ficha, confirmo que li, compreendi e aceitei integralmente os termos e condi√ß√µes aqui estabelecidos, declarando a veracidade de todas as informa√ß√µes fornecidas e ciente da finalidade e dura√ß√£o do armazenamento dos meus dados pessoais.
            </p>
            <p style="text-align: center; font-weight: bold; color: #667eea;">
                üåü Funda√ß√£o Escola Solid√°ria üåü
            </p>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.7.0/jspdf.plugin.autotable.min.js"></script>
    <script>
        // Fun√ß√£o para buscar CEP do aluno
        function buscarCep() {
            var cep = document.getElementById('cep').value.replace(/\D/g, '');
            if (cep.length === 8) {
                fetch(`https://viacep.com.br/ws/${cep}/json/`)
                    .then(response => response.json())
                    .then(data => {
                        if (data.erro) {
                            mostrarNotificacao('CEP n√£o encontrado! üòÖ', 'error');
                        } else {
                            document.getElementById('logradouro').value = data.logradouro;
                            document.getElementById('bairro').value = data.bairro;
                            document.getElementById('cidade').value = data.localidade;
                            document.getElementById('uf').value = data.uf;
                            mostrarNotificacao('Endere√ßo encontrado! üéâ', 'success');
                        }
                    })
                    .catch(error => mostrarNotificacao('Erro ao buscar o CEP! üòî', 'error'));
            } else {
                mostrarNotificacao('Por favor, insira um CEP v√°lido com 8 d√≠gitos! üìÆ', 'warning');
            }
        }

        // Fun√ß√£o para buscar CEP do respons√°vel
        function buscarCepResponsavel() {
            var cep = document.getElementById('cepResponsavel').value.replace(/\D/g, '');
            if (cep.length === 8) {
                fetch(`https://viacep.com.br/ws/${cep}/json/`)
                    .then(response => response.json())
                    .then(data => {
                        if (data.erro) {
                            mostrarNotificacao('CEP n√£o encontrado! üòÖ', 'error');
                        } else {
                            document.getElementById('logradouroResponsavel').value = data.logradouro;
                            document.getElementById('bairroResponsavel').value = data.bairro;
                            document.getElementById('cidadeResponsavel').value = data.localidade;
                            document.getElementById('ufResponsavel').value = data.uf;
                            mostrarNotificacao('Endere√ßo encontrado! üéâ', 'success');
                        }
                    })
                    .catch(error => mostrarNotificacao('Erro ao buscar o CEP! üòî', 'error'));
            } else {
                mostrarNotificacao('Por favor, insira um CEP v√°lido com 8 d√≠gitos! üìÆ', 'warning');
            }
        }

        // Fun√ß√£o para mostrar notifica√ß√µes
        function mostrarNotificacao(mensagem, tipo) {
            // Remove notifica√ß√£o anterior se existir
            const notificacaoAnterior = document.querySelector('.notificacao');
            if (notificacaoAnterior) {
                notificacaoAnterior.remove();
            }

            const notificacao = document.createElement('div');
            notificacao.className = 'notificacao';
            notificacao.textContent = mensagem;
            
            // Estilos baseados no tipo
            const cores = {
                success: 'linear-gradient(135deg, #00b894 0%, #00cec9 100%)',
                error: 'linear-gradient(135deg, #ff7675 0%, #fd79a8 100%)',
                warning: 'linear-gradient(135deg, #fdcb6e 0%, #e17055 100%)'
            };

            notificacao.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${cores[tipo]};
                color: white;
                padding: 1em 1.5em;
                border-radius: 15px;
                box-shadow: 0 8px 20px rgba(0,0,0,0.3);
                z-index: 2000;
                font-weight: 600;
                font-family: 'Nunito', sans-serif;
                animation: slideIn 0.3s ease-out;
            `;

            // Adiciona anima√ß√£o CSS
            if (!document.querySelector('#notificacao-styles')) {
                const styles = document.createElement('style');
                styles.id = 'notificacao-styles';
                styles.textContent = `
                    @keyframes slideIn {
                        from { transform: translateX(100%); opacity: 0; }
                        to { transform: translateX(0); opacity: 1; }
                    }
                    @keyframes slideOut {
                        from { transform: translateX(0); opacity: 1; }
                        to { transform: translateX(100%); opacity: 0; }
                    }
                `;
                document.head.appendChild(styles);
            }

            document.body.appendChild(notificacao);

            // Remove a notifica√ß√£o ap√≥s 3 segundos
            setTimeout(() => {
                notificacao.style.animation = 'slideOut 0.3s ease-in';
                setTimeout(() => notificacao.remove(), 300);
            }, 3000);
        }

        // Fun√ß√£o para preparar impress√£o
        function prepararImpressao() {
            // Valida se os campos obrigat√≥rios est√£o preenchidos
            const form = document.getElementById('fichaForm');
            const camposObrigatorios = form.querySelectorAll('[required]');
            let camposVazios = [];

            camposObrigatorios.forEach(campo => {
                if (!campo.value.trim()) {
                    camposVazios.push(campo.placeholder || campo.name);
                }
            });

            if (camposVazios.length > 0) {
                mostrarNotificacao('Por favor, preencha todos os campos obrigat√≥rios! üìù', 'warning');
                return;
            }

            montarTabelaFicha();
            setTimeout(() => {
                window.print();
                // Ap√≥s impress√£o, esconde a tabela
                setTimeout(() => {
                    const tabela = document.getElementById('fichaTabelaImpressao');
                    if (tabela) tabela.style.display = 'none';
                }, 1000);
            }, 300);
        }

        // Fun√ß√£o para montar tabela de impress√£o
        function montarTabelaFicha() {
            const form = document.getElementById('fichaForm');
            const formData = new FormData(form);
            // Agrupamento dos campos por se√ß√£o
            const quemBuscarLevar = document.getElementById('quemBuscarLevar').value;
            // Foto do aluno
            let fotoAluno = '';
            const inputFoto = document.getElementById('fotoAluno');
            if (inputFoto && inputFoto.files && inputFoto.files[0]) {
                fotoAluno = document.getElementById('previewFotoAluno').src;
            }
            // Foto do outro respons√°vel (rosto)
            let fotoOutrosRosto = '';
            let fotoOutrosRG = '';
            if (quemBuscarLevar === 'outros') {
                const inputFotoOutrosRosto = document.getElementById('fotoOutrosRosto');
                if (inputFotoOutrosRosto && inputFotoOutrosRosto.files && inputFotoOutrosRosto.files[0]) {
                    fotoOutrosRosto = document.getElementById('previewFotoOutrosRosto').src;
                }
                const inputFotoOutrosRG = document.getElementById('fotoOutrosRG');
                if (inputFotoOutrosRG && inputFotoOutrosRG.files && inputFotoOutrosRG.files[0]) {
                    fotoOutrosRG = document.getElementById('previewFotoOutrosRG').src;
                }
            }
            const dados = {
                'Dados do Aluno': [
                    ['Nome Completo', formData.get('nomeAluno') || ''],
                    ['Data de Nascimento', formData.get('dataNascimento') || ''],
                    ['Nacionalidade', formData.get('nacionalidade') || ''],
                    ['Naturalidade', formData.get('naturalidade') || ''],
                    ['G√™nero', formData.get('genero') || ''],
                    ['CEP', formData.get('cep') || ''],
                    ['Logradouro', formData.get('logradouro') || ''],
                    ['N√∫mero', formData.get('numero') || ''],
                    ['Complemento', formData.get('complemento') || ''],
                    ['Bairro', formData.get('bairro') || ''],
                    ['Cidade', formData.get('cidade') || ''],
                    ['Estado', formData.get('uf') || ''],
                    ['Telefone', formData.get('telefone') || ''],
                    ['E-mail', formData.get('email') || ''],
                    ['RG', formData.get('rg') || ''],
                    ['CPF', formData.get('cpf') || ''],
                    ['Certid√£o de Nascimento', formData.get('certidao') || ''],
                    ['Ra√ßa/Cor', formData.get('raca') || ''],
                ],
                'Necessidades Especiais': [
                    ['Possui necessidades especiais?', document.getElementById('necessidadeSelect').value === 'sim' ? 'Sim' : 'N√£o'],
                    ['Especifica√ß√£o', formData.get('especificacaoNecessidade') || ''],
                ],
                'Fam√≠lia do Aluno': [
                    ['Nome do Pai', formData.get('nomePai') || ''],
                    ['Nome da M√£e', formData.get('nomeMae') || ''],
                ],
                'Respons√°vel': [
                    ['Nome do Respons√°vel', formData.get('nomeResponsavel') || ''],
                    ['RG do Respons√°vel', formData.get('rgResponsavel') || ''],
                    ['CPF do Respons√°vel', formData.get('cpfResponsavel') || ''],
                    ['CEP', formData.get('cepResponsavel') || ''],
                    ['Logradouro', formData.get('logradouroResponsavel') || ''],
                    ['N√∫mero', formData.get('numeroResponsavel') || ''],
                    ['Complemento', formData.get('complementoResponsavel') || ''],
                    ['Bairro', formData.get('bairroResponsavel') || ''],
                    ['Cidade', formData.get('cidadeResponsavel') || ''],
                    ['Estado', formData.get('ufResponsavel') || ''],
                    ['Telefone', formData.get('telefoneResponsavel') || ''],
                    ['Profiss√£o', formData.get('profissaoResponsavel') || ''],
                    ['E-mail', formData.get('emailResponsavel') || ''],
                ],
                'Transporte Escolar': [
                    ['Quem busca/leva', quemBuscarLevar === 'pai' ? 'Papai' : quemBuscarLevar === 'mae' ? 'Mam√£e' : quemBuscarLevar === 'outros' ? 'Outra pessoa' : ''],
                ],
                'Sa√∫de': [
                    ['Informa√ß√µes M√©dicas', formData.get('infoMedicas') || ''],
                    ['Plano de Sa√∫de', formData.get('planoSaude') || ''],
                    ['Contato de Emerg√™ncia', formData.get('contatoEmergencia') || ''],
                ],
                'Informa√ß√µes da Fam√≠lia': [
                    ['Renda Familiar', formData.get('rendaFamiliar') || ''],
                    ['Composi√ß√£o Familiar', formData.get('composicaoFamiliar') || ''],
                    ['Benef√≠cios Sociais', formData.get('beneficiosSociais') || ''],
                ]
            };
            // Se for outro, adiciona dados extras
            if (quemBuscarLevar === 'outros') {
                // Nome
                dados['Transporte Escolar'].push(['Nome', formData.get('nomeOutros') || '']);
                // RG (sempre exibe o n√∫mero)
                let rgOutro = formData.get('rgOutros') || '';
                dados['Transporte Escolar'].push(['RG', rgOutro]);
                // Foto do rosto
                if (fotoOutrosRosto) {
                    dados['Transporte Escolar'].push(['Foto 3x4', `<div style=\"margin-top:4px;text-align:left;\"><img src=\"${fotoOutrosRosto}\" alt=\"Foto do rosto\" style=\"max-width:70px;max-height:90px;border-radius:50%;display:block;\"></div>`]);
                }
                // Foto do RG
                if (fotoOutrosRG) {
                    dados['Transporte Escolar'].push(['Foto do Documento (RG)', `<div style=\"margin-top:4px;text-align:left;\"><img src=\"${fotoOutrosRG}\" alt=\"Foto do RG\" style=\"max-width:120px;max-height:80px;border-radius:10px;display:block;\"></div>`]);
                }
                // CPF, Telefone, E-mail
                dados['Transporte Escolar'].push(['CPF', formData.get('cpfOutros') || '']);
                dados['Transporte Escolar'].push(['Telefone', formData.get('telefoneOutros') || '']);
                dados['Transporte Escolar'].push(['E-mail', formData.get('emailOutros') || '']);
            }
            // Monta tabela HTML com imagens sempre dentro das c√©lulas
            let html = '<table id="fichaTabelaImpressao" style="display:none;width:100%;border-collapse:collapse;">';
            // Cabe√ßalho com foto do aluno em c√©lula pr√≥pria
            html += '<tr>';
            html += '<th colspan="2" style="font-size:1.2em;text-align:center;">Ficha de Pr√©-Matr√≠cula do Aluno</th>';
            html += (fotoAluno ? `<th rowspan="7" style="text-align:center;vertical-align:top;"><img src="${fotoAluno}" alt="Foto do aluno" style="width:90px;height:110px;object-fit:cover;border-radius:12px;border:3px solid #ff6b9d;padding:2px;background:#fff;box-shadow:0 2px 8px #ccc;"></th>` : '<th rowspan="7"></th>');
            html += '</tr>';
            html += `<tr><td style="font-weight:bold;width:35%;">Nome Completo</td><td>${formData.get('nomeAluno') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">Data de Nascimento</td><td>${formData.get('dataNascimento') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">Nacionalidade</td><td>${formData.get('nacionalidade') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">Naturalidade</td><td>${formData.get('naturalidade') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">G√™nero</td><td>${formData.get('genero') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">CEP</td><td>${formData.get('cep') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">Logradouro</td><td>${formData.get('logradouro') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">N√∫mero</td><td>${formData.get('numero') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">Complemento</td><td>${formData.get('complemento') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">Bairro</td><td>${formData.get('bairro') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">Cidade</td><td>${formData.get('cidade') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">Estado</td><td>${formData.get('uf') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">Telefone</td><td>${formData.get('telefone') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">E-mail</td><td>${formData.get('email') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">RG</td><td>${formData.get('rg') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">CPF</td><td>${formData.get('cpf') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">Certid√£o de Nascimento</td><td>${formData.get('certidao') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">Ra√ßa/Cor</td><td>${formData.get('raca') || ''}</td></tr>`;
            html += `<tr><th colspan="2" style="background:#f2f2f2;font-weight:bold;">Necessidades Especiais</th></tr>`;
            html += `<tr><td style="font-weight:bold;">Possui necessidades especiais?</td><td>${document.getElementById('necessidadeSelect').value === 'sim' ? 'Sim' : 'N√£o'}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">Especifica√ß√£o</td><td>${formData.get('especificacaoNecessidade') || ''}</td></tr>`;
            html += `<tr><th colspan="2" style="background:#f2f2f2;font-weight:bold;">Fam√≠lia do Aluno</th></tr>`;
            html += `<tr><td style="font-weight:bold;">Nome do Pai</td><td>${formData.get('nomePai') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">Nome da M√£e</td><td>${formData.get('nomeMae') || ''}</td></tr>`;
            html += `<tr><th colspan="2" style="background:#f2f2f2;font-weight:bold;">Respons√°vel</th></tr>`;
            html += `<tr><td style="font-weight:bold;">Nome do Respons√°vel</td><td>${formData.get('nomeResponsavel') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">RG do Respons√°vel</td><td>${formData.get('rgResponsavel') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">CPF do Respons√°vel</td><td>${formData.get('cpfResponsavel') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">CEP</td><td>${formData.get('cepResponsavel') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">Logradouro</td><td>${formData.get('logradouroResponsavel') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">N√∫mero</td><td>${formData.get('numeroResponsavel') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">Complemento</td><td>${formData.get('complementoResponsavel') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">Bairro</td><td>${formData.get('bairroResponsavel') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">Cidade</td><td>${formData.get('cidadeResponsavel') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">Estado</td><td>${formData.get('ufResponsavel') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">Telefone</td><td>${formData.get('telefoneResponsavel') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">Profiss√£o</td><td>${formData.get('profissaoResponsavel') || ''}</td></tr>`;
            html += `<tr><td style="font-weight:bold;">E-mail</td><td>${formData.get('emailResponsavel') || ''}</td></tr>`;
            // Transporte Escolar (ajuste para fotos do Outro)
            html += `<tr><th colspan="3" style="background:#f2f2f2;font-weight:bold;">Transporte Escolar</th></tr>`;
            html += `<tr><td style="font-weight:bold;">Quem busca/leva</td><td colspan="2">${quemBuscarLevar === 'pai' ? 'Papai' : quemBuscarLevar === 'mae' ? 'Mam√£e' : quemBuscarLevar === 'outros' ? 'Outra pessoa' : ''}</td></tr>`;
            // √öLTIMA P√ÅGINA - Campo Outro com foto, nome e RG organizados
            if (quemBuscarLevar === 'outros') {
                html += '<tr style="page-break-before: always;"><th colspan="3" style="background:#f2f2f2;font-weight:bold;padding-top:20px;">Transporte Escolar - Outro</th></tr>';
                // Linha com foto 3x4 e nome lado a lado
                html += '<tr>';
                html += `<td style="text-align:center;width:110px;vertical-align:top;">${fotoOutrosRosto ? `<img src="${fotoOutrosRosto}" alt="Foto do rosto" style="width:90px;height:110px;object-fit:cover;border-radius:50%;border:3px solid #0984e3;padding:2px;background:#fff;box-shadow:0 2px 8px #ccc;">` : ''}</td>`;
                html += `<td colspan="2" style="vertical-align:middle;font-size:1.1em;"><b>${formData.get('nomeOutros') || ''}</b></td>`;
                html += '</tr>';
                // Linha com RG (imagem) abaixo da foto
                html += '<tr>';
                html += `<td colspan="3" style="text-align:center;padding-top:10px;">${fotoOutrosRG ? `<div><b>RG:</b><br><img src="${fotoOutrosRG}" alt="Foto do RG" style="max-width:220px;height:auto;border-radius:10px;border:3px solid #0984e3;padding:2px;background:#fff;box-shadow:0 2px 8px #ccc;margin-top:6px;"></div>` : ''}</td>`;
                html += '</tr>';
                // Demais dados
                html += `<tr><td style="font-weight:bold;">CPF</td><td colspan="2">${formData.get('cpfOutros') || ''}</td></tr>`;
                html += `<tr><td style="font-weight:bold;">Telefone</td><td colspan="2">${formData.get('telefoneOutros') || ''}</td></tr>`;
                html += `<tr><td style="font-weight:bold;">E-mail</td><td colspan="2">${formData.get('emailOutros') || ''}</td></tr>`;
            }
            // Adiciona se√ß√£o de Sa√∫de completa
            html += `<tr><th colspan='3' style='background:#f2f2f2;font-weight:bold;'>Informa√ß√µes de Sa√∫de</th></tr>`;
            html += `<tr><td style='font-weight:bold;'>Informa√ß√µes M√©dicas</td><td colspan='2'>${formData.get('infoMedicas') || ''}</td></tr>`;
            html += `<tr><td style='font-weight:bold;'>Plano de Sa√∫de</td><td colspan='2'>${formData.get('planoSaude') || ''}</td></tr>`;
            html += `<tr><td style='font-weight:bold;'>Contato de Emerg√™ncia</td><td colspan='2'>${formData.get('contatoEmergencia') || ''}</td></tr>`;
            html += '</table>';
            // Remove tabela anterior se existir
            const anterior = document.getElementById('fichaTabelaImpressao');
            if (anterior) anterior.remove();
            // Insere tabela no DOM
            const container = document.getElementById('form-content');
            container.insertAdjacentHTML('beforeend', html);
            // Exibe tabela para impress√£o
            document.getElementById('fichaTabelaImpressao').style.display = 'table';
        }

        // Exporta√ß√£o PDF usando jsPDF + autoTable
        function exportarPDF() {
            montarTabelaFicha();
            const tabela = document.getElementById('fichaTabelaImpressao');
            const doc = new window.jspdf.jsPDF({ orientation: 'portrait', unit: 'mm', format: 'a4' });
            doc.setFont('helvetica');
            doc.setFontSize(12);
            // Cabe√ßalho
            doc.text('Ficha de Pr√©-Matr√≠cula do Aluno', 105, 15, { align: 'center' });

            // Foto do aluno (busca na primeira linha de imagem)
            const imgAluno = tabela.querySelector('img[alt="Foto do aluno"]');
            if (imgAluno && imgAluno.src && imgAluno.src.startsWith('data:image')) {
                doc.addImage(imgAluno.src, 'JPEG', 160, 20, 35, 40);
            }

            // Monta dados para autoTable (exceto imagens)
            let body = [];
            let encontrouOutro = false;
            for (let row of tabela.rows) {
                let tds = row.querySelectorAll('td, th');
                // Detecta in√≠cio da se√ß√£o Outro
                if (tds.length === 3 && tds[0].textContent.includes('Transporte Escolar - Outro')) {
                    encontrouOutro = true;
                    continue;
                }
                if (!encontrouOutro && tds.length === 2) {
                    let campo = tds[0].innerText;
                    let valor = tds[1].innerText;
                    if (!campo.toLowerCase().includes('foto')) {
                        body.push([campo, valor]);
                    }
                }
            }
            doc.autoTable({
                startY: 65,
                head: [],
                body: body,
                theme: 'grid',
                styles: { font: 'helvetica', fontSize: 11, textColor: 20, lineColor: 50, lineWidth: 0.2 },
                headStyles: { fillColor: [242,242,242], textColor: 20, fontStyle: 'bold' },
                columnStyles: { 0: { cellWidth: 60 }, 1: { cellWidth: 100 } },
                margin: { left: 15, right: 15 },
                tableWidth: 'auto',
            });

            // Se√ß√£o Outro na √∫ltima p√°gina
            const outroHeader = tabela.querySelector('tr[style*="page-break-before"]');
            if (outroHeader) {
                doc.addPage();
                doc.text('Transporte Escolar - Outro', 105, 20, { align: 'center' });
                // Foto 3x4 e nome lado a lado
                const imgOutro = tabela.querySelector('img[alt="Foto do rosto"]');
                const nomeOutro = tabela.querySelector('tr[style*="page-break-before"] + tr td[colspan="2"] b');
                if (imgOutro && imgOutro.src && imgOutro.src.startsWith('data:image')) {
                    doc.addImage(imgOutro.src, 'JPEG', 25, 35, 35, 45);
                }
                if (nomeOutro) {
                    doc.text('Nome:', 65, 45);
                    doc.text(nomeOutro.textContent, 65, 55);
                }
                // RG abaixo da foto
                const imgRG = tabela.querySelector('img[alt="Foto do RG"]');
                if (imgRG && imgRG.src && imgRG.src.startsWith('data:image')) {
                    doc.text('RG:', 25, 90);
                    doc.addImage(imgRG.src, 'JPEG', 25, 95, 60, 30);
                }
                // Demais dados do Outro
                let y = 130;
                let tr = outroHeader.nextElementSibling;
                while (tr) {
                    let tds = tr.querySelectorAll('td');
                    if (tds.length === 3 || tds.length === 0) { tr = tr.nextElementSibling; continue; }
                    let campo = tds[0].innerText;
                    let valor = tds[1] ? tds[1].innerText : '';
                    if (!campo.toLowerCase().includes('foto') && campo !== 'Nome' && campo !== 'RG') {
                        doc.text(`${campo}: ${valor}`, 25, y);
                        y += 10;
                    }
                    tr = tr.nextElementSibling;
                }
            }
            doc.save('Ficha_Pre_Matricula.pdf');
            tabela.style.display = 'none';
        }

        // Exportar como HTML para impress√£o
        function exportarComoHTML() {
            montarTabelaFicha();
            const tabela = document.getElementById('fichaTabelaImpressao');
            // Cria um novo documento HTML moderno e pronto para impress√£o
            let html = `<!DOCTYPE html><html lang='pt-BR'><head><meta charset='UTF-8'><meta name='viewport' content='width=device-width, initial-scale=1.0'>`;
            html += `<title>Ficha de Pr√©-Matr√≠cula para Impress√£o</title>`;
            html += `<link href='https://fonts.googleapis.com/css2?family=Fredoka+One:wght@400&family=Nunito:wght@300;400;600;700&display=swap' rel='stylesheet'>`;
            html += `<style>
                body { font-family: 'Nunito', sans-serif; background: #fff; color: #222; margin: 0; padding: 0; }
                .ficha-container { max-width: 900px; margin: 2em auto; background: #fff; border-radius: 18px; box-shadow: 0 8px 32px #0001; padding: 2em; }
                table { width: 100%; border-collapse: separate; border-spacing: 0 8px; table-layout: fixed; }
                th, td { padding: 10px 12px; text-align: left; font-size: 1em; word-break: break-word; max-width: 0; }
                td { max-width: 350px; white-space: pre-line; }
                @media print { body, html { background: #fff !important; color: #000 !important; } .ficha-container { box-shadow: none !important; border: none !important; } }
            </style></head><body><div class='ficha-container'>`;
            html += tabela.outerHTML;
            html += `</div></body></html>`;
            // Cria um blob e abre em nova aba
            const blob = new Blob([html], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            window.open(url, '_blank');
            tabela.style.display = 'none';
        }

        // Fun√ß√£o para abrir modal
        function abrirModal() {
            const modal = document.getElementById('modalTermos');
            modal.style.display = "block";
            modal.setAttribute('aria-hidden', "false");
            document.body.style.overflow = 'hidden'; // Impede scroll do body
        }

        // Fun√ß√£o para fechar modal
        function fecharModal() {
            const modal = document.getElementById('modalTermos');
            modal.style.display = "none";
            modal.setAttribute('aria-hidden', "true");
            document.body.style.overflow = 'auto'; // Restaura scroll do body
        }

        // Fun√ß√£o para toggle necessidades especiais
        function toggleNecessidadeInput() {
            const select = document.getElementById('necessidadeSelect');
            const input = document.getElementById('necessidadeInput');
            if (select.value === 'sim') {
                input.style.display = 'block';
                input.querySelector('input').focus();
            } else {
                input.style.display = 'none';
            }
        }

        // Fun√ß√£o para toggle outros dados
        function toggleOutrosDados() {
            const select = document.getElementById('quemBuscarLevar');
            const outrosDados = document.getElementById('outrosDados');
            if (select.value === 'outros') {
                outrosDados.style.display = 'block';
                outrosDados.querySelector('input').focus();
            } else {
                outrosDados.style.display = 'none';
            }
        }

        // Fun√ß√£o para preview de imagem
        function previewImage(inputId, imgId) {
            const input = document.getElementById(inputId);
            const img = document.getElementById(imgId);
            
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    img.src = e.target.result;
                    img.style.display = 'block';
                    
                    // Adiciona efeito de entrada
                    img.style.opacity = '0';
                    img.style.transform = 'scale(0.8)';
                    
                    setTimeout(() => {
                        img.style.transition = 'all 0.3s ease';
                        img.style.opacity = '1';
                        img.style.transform = 'scale(1)';
                    }, 100);
                    
                    mostrarNotificacao('Foto adicionada com sucesso! üì∏', 'success');
                }
                
                reader.readAsDataURL(input.files[0]);
            }
        }

        // Fun√ß√£o para valida√ß√£o em tempo real
        function adicionarValidacaoTempoReal() {
            const inputs = document.querySelectorAll('input, textarea, select');
            
            inputs.forEach(input => {
                input.addEventListener('blur', function() {
                    if (this.hasAttribute('required') && !this.value.trim()) {
                        this.style.borderColor = '#ff7675';
                        this.style.backgroundColor = '#fff5f5';
                    } else if (this.value.trim()) {
                        this.style.borderColor = '#00b894';
                        this.style.backgroundColor = '#f0fff4';
                    }
                });

                input.addEventListener('focus', function() {
                    this.style.borderColor = '#ff6b9d';
                    this.style.backgroundColor = '#fff';
                });
            });
        }

        // Fun√ß√£o para m√°scaras de input
        function adicionarMascaras() {
            // M√°scara para CEP
            const cepInputs = document.querySelectorAll('input[name="cep"], input[name="cepResponsavel"]');
            cepInputs.forEach(input => {
                input.addEventListener('input', function() {
                    let value = this.value.replace(/\D/g, '');
                    value = value.replace(/^(\d{5})(\d)/, '$1-$2');
                    this.value = value;
                });
            });

            // M√°scara para telefone
            const telefoneInputs = document.querySelectorAll('input[type="tel"]');
            telefoneInputs.forEach(input => {
                input.addEventListener('input', function() {
                    let value = this.value.replace(/\D/g, '');
                    value = value.replace(/^(\d{2})(\d)/g, '($1) $2');
                    value = value.replace(/(\d)(\d{4})$/, '$1-$2');
                    this.value = value;
                });
            });

            // M√°scara para CPF
            const cpfInputs = document.querySelectorAll('input[name="cpf"], input[name="cpfResponsavel"], input[name="cpfOutros"]');
            cpfInputs.forEach(input => {
                input.addEventListener('input', function() {
                    let value = this.value.replace(/\D/g, '');
                    value = value.replace(/(\d{3})(\d)/, '$1.$2');
                    value = value.replace(/(\d{3})(\d)/, '$1.$2');
                    value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
                    this.value = value;
                });
            });
        }

        // Event listeners para modal
        window.onclick = function(event) {
            const modal = document.getElementById('modalTermos');
            if (event.target == modal) {
                fecharModal();
            }
        }

        // Escape key para fechar modal
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const modal = document.getElementById('modalTermos');
                if (modal.style.display === 'block') {
                    fecharModal();
                }
            }
        });

        // Inicializa√ß√£o quando a p√°gina carrega
        document.addEventListener('DOMContentLoaded', function() {
            adicionarValidacaoTempoReal();
            adicionarMascaras();
            
            // Adiciona efeito de carregamento
            const formContainer = document.querySelector('.form-container');
            formContainer.style.opacity = '0';
            formContainer.style.transform = 'translateY(30px)';
            
            setTimeout(() => {
                formContainer.style.transition = 'all 0.8s ease';
                formContainer.style.opacity = '1';
                formContainer.style.transform = 'translateY(0)';
            }, 200);

            // Mensagem de boas-vindas
            setTimeout(() => {
                mostrarNotificacao('Bem-vindos √† nossa escola! üåü', 'success');
            }, 1500);
        });

        // Fun√ß√£o para salvar dados localmente (opcional)
        function salvarRascunho() {
            const form = document.getElementById('fichaForm');
            const formData = new FormData(form);
            const data = {};
            
            for (let [key, value] of formData.entries()) {
                data[key] = value;
            }
            
            // Salva no localStorage (apenas para demonstra√ß√£o)
            // Em produ√ß√£o, seria melhor usar um banco de dados
            try {
                localStorage.setItem('rascunho_ficha', JSON.stringify(data));
                mostrarNotificacao('Rascunho salvo! üíæ', 'success');
            } catch (error) {
                console.log('N√£o foi poss√≠vel salvar o rascunho');
            }
        }

        // Auto-save a cada 30 segundos
        setInterval(salvarRascunho, 30000);
    </script>
</body>
</html>
